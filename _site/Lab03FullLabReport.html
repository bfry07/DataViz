<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Brian Fry, Olja Busbaher, Beatriz Delclaux" />


<title>Hallucinogen Use</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Visualizations
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Lab03FullLabReport.html">Hallucinogen Use</a>
    </li>
    <li>
      <a href="lab04.html">DC Migration</a>
    </li>
    <li>
      <a href="lab06.html">Diamonds</a>
    </li>
    <li>
      <a href="lab05.html">Women in Congress</a>
    </li>
    <li>
      <a href="Final_Project_Final.html">Race and Electoral &amp; Economic Outcomes in the United States</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Hallucinogen Use</h1>
<h4 class="author"><em>Brian Fry, Olja Busbaher, Beatriz Delclaux</em></h4>

</div>


<div id="load-and-filter-data" class="section level2">
<h2>Load and Filter Data</h2>
<p>First, we load the full data set. Next, we define regular use of hallucinogens as 20 uses per year. Finally, we filter out the regular users and those who have never used hallucinogens from the data.</p>
<pre class="r"><code>load(&quot;36361-0001-Data.rda&quot;)


library(tidyverse)
library(gridExtra)

HALLUSE &lt;- filter(da36361.0001, LSD %in% c(&quot;(1) Yes&quot;,&quot;(2) No&quot;))
AUINPYR &lt;- filter(da36361.0001, AUINPYR %in% c(&quot;(1) Yes&quot;,&quot;(2) No&quot;))

regular_use_criteria &lt;- 20
non_regular_use_criteria &lt;- 19

regular_users &lt;- filter(da36361.0001, HALYRTOT &gt;= regular_use_criteria)
nonregular_users &lt;- filter(da36361.0001, HALYRTOT &lt;= non_regular_use_criteria)
never_users &lt;- filter(da36361.0001, is.na(LSD))</code></pre>
</div>
<div id="initial-visualizations" class="section level2">
<h2>Initial Visualizations</h2>
<p>First, we created a visual representation showing the percent of respondents who have ever used hallucinogens.</p>
<pre class="r"><code>HALLUSE$user_status &lt;- &quot;user&quot;
never_users$user_status &lt;- &quot;never used&quot;

HALLALL &lt;- rbind (HALLUSE, never_users)

ggplot(HALLALL)+
  geom_bar(aes(x=user_status, y=..count../sum(..count..),fill=user_status))+
  scale_x_discrete(labels=c(&quot;Never Used&quot;, &quot;Ever Users&quot;))+
  labs(title=&quot;Self-Reported Hallucinogen Use in the United States&quot;, x=&quot;User Category&quot;, y=&quot;Percentage&quot;)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Second, we created a visual representation of how long ago those who have ever used hallucinogens last used hallucinogens. To do this, we had to filter from the HALLUSE data by the responses to the question “How long ago did you last use a hallucinogen?” Then, we used ggplot to display the data.</p>
<pre class="r"><code>use_freq_data &lt;- filter(HALLUSE, HALLUSE$HALLREC %in% c(&quot;(03) More than 12 months ago&quot;, &quot;(02) More than 30 days ago but within the past 12 mos&quot;, &quot;(01) Within the past 30 days&quot;))

ggplot(use_freq_data)+geom_bar(aes(use_freq_data$HALLREC))+coord_flip()+labs(title =&quot;Among those who have ever used\n hallucinogens, how long has it\n been since they last used them?&quot;,x=&quot;Time Since Last Used&quot;, y = &quot;Frequency&quot;)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Third, we made a chart which displays the answer to the question “What percent of survey respondents are currently regular users?” In answering this question, we defined regular user as one who uses hallucinogens 20 dyas or more per year.</p>
<pre class="r"><code>current_use_criteria &lt;-filter(da36361.0001, HALLREC %in% c(&quot;(01) Within the past 30 days&quot;,&quot;(02) More than 30 days ago but within the past 12 mos&quot;))

current_use_criteria &lt;- mutate(current_use_criteria, regular_use = HALYRTOT &gt;= regular_use_criteria)

plotbar &lt;- ggplot(current_use_criteria)+
  geom_bar(aes(x=0), fill=&quot;red&quot;)+
  geom_bar(data=regular_users, aes(x=1), fill=&quot;blue&quot;)+
  scale_x_continuous(breaks=c(0,1),labels=c(&quot;Not Regular&quot;, &quot;Regular Users&quot;))+
  labs(title=&quot;Currently Regular Users&quot;, x=&quot;User Category&quot;, y=&quot;Count&quot;)

plotpie &lt;- ggplot(filter(current_use_criteria,!is.na(regular_use)))+geom_bar(aes(x=1, fill=regular_use))+coord_polar(theta=&quot;y&quot;)

grid.arrange(plotbar, plotpie)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/filter%20current%20users%20&%20create%20current-regular%20users%20graph-1.png" width="672" /></p>
</div>
<div id="part-a" class="section level2">
<h2>Part A</h2>
<p>Here we create a histogram showing how often regular users of hallucinogens use hallucinogens as shown by days per year that the user uses hallucinogens.</p>
<pre class="r"><code>days_used &lt;- as.data.frame(regular_users$HALYRTOT)
ggplot(data=regular_users, aes(x=days_used)) + 
  geom_histogram(breaks=seq(20, 365, by=10))</code></pre>
<pre><code>## Don&#39;t know how to automatically pick scale for object of type data.frame. Defaulting to continuous.</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="part-b" class="section level2">
<h2>Part B</h2>
<p>Here we compare the usage profiles of those who began hallucinogen use early vs. those who began late. We defined the cut-off age for early to late as 21 years old. We decided to make a layered histogram contrasting regular users who started using hallucinogens early, before 21 years old, and those who started late, after 21 years old.</p>
<pre class="r"><code>early_use_criteria &lt;-21

early_user &lt;- filter(regular_users, HALLAGE &lt; early_use_criteria)
late_users &lt;-filter(regular_users, HALLAGE &gt;= early_use_criteria)

days_used_early &lt;-as.data.frame(early_user$HALYRTOT)
days_used_late &lt;-as.data.frame(late_users$HALYRTOT)

ggplot()+
  geom_histogram(data=early_user, aes(x=days_used_early, fill=&quot;Early Users&quot;), breaks=seq(20, 365, by=10))+
  geom_histogram(data=late_users, aes(x=days_used_late, fill=&quot;Late Users&quot;), breaks=seq(20, 365, by=10))+
  labs(title = &quot;Days Hallucinogens Used Per Year, by Early and Late Users&quot;, x = &quot;Days Hallucinogen Used&quot;, y = &quot;Days&quot;)+
  scale_fill_manual(name=&quot;User Status&quot;, values = c(&quot;Early Users&quot; = &quot;green&quot;, &quot;Late Users&quot; = &quot;red&quot;), labels=c(&quot;Early Users&quot;, &quot;Late Users&quot;))</code></pre>
<pre><code>## Don&#39;t know how to automatically pick scale for object of type data.frame. Defaulting to continuous.</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="part-c" class="section level2">
<h2>Part C</h2>
</div>
<div id="a-hallucinogen-user-status-compared-to-response-to-the-question-have-you-been-hospitalized-in-the-last-12-months-for-mental-health-related-issues" class="section level1">
<h1>(a) Hallucinogen user status compared to response to the question “Have you been hospitalized in the last 12 months for mental health related issues?”</h1>
<ol style="list-style-type: lower-roman">
<li>Hospitalization status as the independent variable.</li>
</ol>
<p>In this section, we decided to make a stacked bar chart portraying the people who have been hospitalizated in the past twelve months in the United States given they were never users, non regular users and regular users.</p>
<pre class="r"><code>modified_data &lt;- mutate(HALLUSE, 
                        hospital_status = ifelse(AUINPYR==&quot;(1) Yes&quot;, &quot;hospitalized&quot;,&quot;not hospitalized&quot;))

regular_users$user_status &lt;- &quot;regular&quot;
nonregular_users$user_status &lt;- &quot;non regular&quot;
never_users$user_status &lt;- &quot;never&quot;

combined_data &lt;- rbind(regular_users, nonregular_users, never_users)

ggplot(filter(combined_data,!is.na(AUINPYR))) +
  geom_bar(aes(x=user_status,fill=AUINPYR),position=&quot;fill&quot;)+
  scale_x_discrete(labels=c(&quot;Never Users&quot;, &quot;Non Regular Users&quot;, &quot;Regular Users&quot;))+
  scale_fill_brewer(name=&quot;Hospitalized&quot;, palette=&quot;Dark2&quot;,labels=c(&quot;Yes&quot;,&quot;No&quot;))+
  labs(title=&quot;People who have been hospitalized in the past twelve months in the United States&quot;, x=&quot;User Category&quot;, y=&quot;Proportional Frequency&quot;)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<ol start="2" style="list-style-type: lower-roman">
<li>This visulization displays the same comparison as the previous but with user status as the independent variable.</li>
</ol>
<pre class="r"><code>hospitalized &lt;- filter(combined_data, AUINPYR == &quot;(1) Yes&quot;)
nothospitalized &lt;- filter(combined_data, AUINPYR == &quot;(2) No&quot;)

#hospitalized$user_status &lt;- &quot;hospitalized&quot;
#nothospitalized$user_status &lt;- &quot;not hospitalized&quot;

#combined_data_2 &lt;- rbind(hospitalized_users, nothospitalized_users)

ggplot (filter(combined_data,!is.na(AUINPYR)))+
  geom_bar(aes(x=AUINPYR, fill=user_status),position = &quot;fill&quot;)+
  scale_fill_brewer(name=&quot;User Status&quot;, palette=&quot;Dark2&quot;, labels=c(&quot;Never&quot;, &quot;Non Regular&quot;, &quot;Regular&quot;))+
  labs(title=&quot;Proportion of hallucinogen users who have been hospitalized&quot;, x=&quot;Hospitalized Situation&quot;, y=&quot;Frequency&quot;)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>#ggplot (filter(combined_data,!is.na(AUINPYR)))+
 # geom_bar(aes(fill=AUINPYR, x=user_status),position = &quot;fill&quot;)</code></pre>
<ol start="3" style="list-style-type: lower-roman">
<li>This visualization displays the same comparioson as the last two but in the form of two pie charts.</li>
</ol>
<pre class="r"><code>g1 &lt;- ggplot(hospitalized) + geom_bar(aes(x=1,fill=user_status)) + coord_polar(theta=&quot;y&quot;)

g2 &lt;- ggplot(nothospitalized) + geom_bar(aes(x=1,fill=user_status)) + coord_polar(theta=&quot;y&quot;)

grid.arrange(g1,g2)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="b-hallucinogen-user-status-compared-to-the-response-to-the-question-have-you-ever-been-treated-for-alcohol-or-drug-abuse" class="section level1">
<h1>(b) Hallucinogen user status compared to the response to the question “Have you ever been treated for alcohol or drug abuse?”</h1>
<ol style="list-style-type: lower-roman">
<li>Sustance treatment status as the independent variable.</li>
</ol>
<p>In this section, we decided to make a stacked bar chart portraying the people who have received substance treatment for alcohol or drug use in the United States given they were never users, non regular users and regular users.</p>
<pre class="r"><code>SUBTRT &lt;- filter(da36361.0001, TXEVER %in% c(&quot;(1) Yes&quot;,&quot;(2) No&quot;))

modified_data2 &lt;- mutate(HALLUSE, 
                        treatment_status = ifelse(TXEVER==&quot;(1) Yes&quot;, &quot;received substance treatment&quot;,&quot;never received&quot;))

ggplot(filter(combined_data,!is.na(TXEVER))) +
  geom_bar(aes(x=user_status,fill=TXEVER),position=&quot;fill&quot;)+
  scale_x_discrete(labels=c(&quot;Never Users&quot;, &quot;Non Regular Users&quot;, &quot;Regular Users&quot;))+
  scale_fill_brewer(name=&quot;Substance Treatment&quot;, palette=&quot;Dark2&quot;,labels=c(&quot;Yes&quot;,&quot;No&quot;))+
  labs(title=&quot;People who have received drug or alcohol treament in the United States&quot;, x=&quot;User Category&quot;, y=&quot;Proportional Frequency&quot;)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/Second%20variable:%20Ever%20received%20drug%20or%20alcohol%20substance%20treatment-1.png" width="672" /></p>
<ol start="2" style="list-style-type: lower-roman">
<li>This visulization displays the same comparison as the previous but with user status as the independent variable.</li>
</ol>
<pre class="r"><code>ggplot(filter(combined_data, !is.na(TXEVER))) +
  geom_bar(aes(x=TXEVER,fill=user_status),position=&quot;fill&quot;)+
  scale_x_discrete(labels=c(&quot;Received Treatment&quot;, &quot;Never Received&quot;))+
  scale_fill_brewer(name=&quot;User Status&quot;, palette=&quot;Dark2&quot;,labels=c(&quot;Never&quot;,&quot;Non-Regular&quot;, &quot;Regular&quot;))+
  labs(title=&quot;People who have received drug or alcohol treament in the United States&quot;, x=&quot;Treatment Status&quot;, y=&quot;Proportional Frequency&quot;)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<ol start="3" style="list-style-type: lower-roman">
<li>This visualization displays the same comparioson as the last two but in the form of two pie charts.</li>
</ol>
<pre class="r"><code>received &lt;-filter(combined_data, TXEVER == &quot;(1) Yes&quot;)
notreceived &lt;- filter(combined_data, TXEVER == &quot;(2) No&quot;)

plot1 &lt;- ggplot(received) + geom_bar(aes(x=1,fill=user_status)) + coord_polar(theta=&quot;y&quot;)+labs(title=&quot;People who have received alcohol/drug treatment in the United States&quot;)

plot2 &lt;- ggplot(notreceived) + geom_bar(aes(x=1, fill=user_status)) + coord_polar(theta=&quot;y&quot;) +labs(title=&quot;People who have not received drug/alcohol treatment in the United States&quot;)

grid.arrange(plot1, plot2)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="c-hallucinogen-use-compared-to-the-response-to-the-question-how-important-are-your-religious-beliefs-to-you" class="section level1">
<h1>(c) Hallucinogen use compared to the response to the question “How important are your religious beliefs to you?”</h1>
<ol style="list-style-type: lower-roman">
<li>In this first visualization, the response to the religious belief question is the independent variable while the user status (ever used or never used hallucinogens) is the dependent variable.</li>
</ol>
<pre class="r"><code>da36361.0001 &lt;- mutate(da36361.0001, ever_used = LSD %in% c(&quot;(1) Yes&quot;,&quot;(2) No&quot;))

religion_importance &lt;- filter(da36361.0001, SNRLGIMP %in% c(&quot;(1) Strongly Disagree&quot;, &quot;(2) Disagree&quot;, &quot;(3) Agree&quot;, &quot;(4) Strongly Agree&quot;))

ggplot(religion_importance, aes(x=religion_importance$SNRLGIMP, fill=ever_used))+geom_bar(position=&quot;dodge&quot;)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<ol start="2" style="list-style-type: lower-roman">
<li>In the second visualization, the user status is the indepent variable while the response to the religious belief question is the dependent variable.</li>
</ol>
<pre class="r"><code>ggplot(religion_importance, aes(x=religion_importance$ever_used, fill=religion_importance$SNRLGIMP))+geom_bar(position = &quot;fill&quot;)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<ol start="3" style="list-style-type: lower-roman">
<li>Finally, I will also make two pie charts, one for those who regularly use hallucinogens and one for those who have never, displaying the internal break down of the answer to the question about religious beliefs.</li>
</ol>
<pre class="r"><code># This one shows the regular user breakdown
reg_relig &lt;- filter(regular_users, SNRLGIMP %in% c(&quot;(1) Strongly Disagree&quot;, &quot;(2) Disagree&quot;, &quot;(3) Agree&quot;, &quot;(4) Strongly Agree&quot;))
g1 &lt;- ggplot(reg_relig)+geom_bar(aes(x=1, fill=reg_relig$SNRLGIMP))+coord_polar(theta=&quot;y&quot;)

# This one shows the never users breakdown
never_relig &lt;- filter(never_users, SNRLGIMP %in% c(&quot;(1) Strongly Disagree&quot;, &quot;(2) Disagree&quot;, &quot;(3) Agree&quot;, &quot;(4) Strongly Agree&quot;))
g2&lt;- ggplot(never_relig)+geom_bar(aes(x=1, fill=never_relig$SNRLGIMP))+coord_polar(theta=&quot;y&quot;)

grid.arrange(g1, g2)</code></pre>
<p><img src="Lab03FullLabReport_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
